var PUM_ATB;!function(e,t,i){"use strict";var n=i.I10n;PUM_ATB={_singleImageSelector:null,_init:function(){PUM_ATB._event_listeners(),e(t).ready(function(){var t=e(".color-picker.initialized");e("select[data-toggle]").trigger("change"),t.trigger("change.update"),void 0!==i.user_palette&&t.iris("option","palettes",i.user_palette)})},_event_listeners:function(){e(t).on("popmake-admin-retheme",PUM_ATB._process_css).on("change","select[data-toggle]",PUM_ATB._settingsSelectChanged).on("click",".pum-image-field .pum-image-select",PUM_ATB._selectSingleImage).on("click",".pum-image-field .pum-image-edit",PUM_ATB._selectSingleImage).on("click",".pum-image-field .pum-image-replace",PUM_ATB._selectSingleImage).on("click",".pum-image-field .pum-image-remove",PUM_ATB._singleImageRemoved).on("change.update change.clear",".color-picker.initialized",PUM_ATB._update_color_opacity)},_update_color_opacity:function(){var t=e(this),i=t.parents("tr").eq(0).next("tr");""!==t.val()?i.show():i.hide()},_process_css:function(t,i){var n,a,o=e("#pum-atb-theme-styles"),l="",s={overlay:"#PopMake-Preview .example-popup-overlay",container:"#PopMake-Preview .example-popup",close:"#PopMake-Preview .close-popup"};l+='#PopMake-Preview .example-popup-overlay::after, #PopMake-Preview .example-popup::after, #PopMake-Preview .close-popup::after { content: ""; display: block; position: absolute; top: 0; right: 0; bottom: 0; left: 0; z-index: -1; }',l+="#PopMake-Preview .example-popup-overlay::after { z-index: 0; }";for(var r in s)if(s.hasOwnProperty(r)){switch(a=s[r],n="",i[r+"_bg_type"]){case"color":n+=a+" {",n+="background: "+PUMUtils.convert_hex(i[r+"_bg_color"],i[r+"_bg_opacity"])+"!important;",n+="}";break;case"image":n+=a+" {",n+="background-color: "+PUMUtils.convert_hex(i[r+"_bg_color"],i[r+"_bg_opacity"])+"!important;",n+="background-position: "+i[r+"_bg_position"]+"!important;",n+="background-image: url("+i[r+"_bg_image_src"]+")!important;",n+="background-repeat: "+i[r+"_bg_repeat"]+"!important;",n+="background-size: "+i[r+"_bg_size"]+"!important;",n+="background-attachment: "+i[r+"_bg_attachment"]+"!important;",n+="}",n+=a+"::after {",n+="background-color: "+PUMUtils.convert_hex(i[r+"_bg_overlay_color"],i[r+"_bg_overlay_opacity"])+"!important;",n+="}";break;case"none":n+=a+" {",n+="background: none!important;",n+="}"}l+=n}o.length?o.replaceWith(e('<style id="pum-atb-theme-styles">'+l+"</style>")):e('<style id="pum-atb-theme-styles">'+l+"</style>").appendTo("head")},_settingsSelectChanged:function(){var t=e(this),i=t.data("toggle"),n=t.val(),a=0,o=0;if("undefined"!=typeof i){"string"==typeof i&&(i=JSON.parse(i));for(a in i)if(i.hasOwnProperty(a))for(o in i[a].sections)i[a].sections.hasOwnProperty(o)&&e("."+i[a].sections[o]).hide();if("undefined"!=typeof i[n])for(o in i[n].sections)i[n].sections.hasOwnProperty(o)&&e("."+i[n].sections[o]).show()}},_settingsSelectToggle:function(t,i,n,a){var o=0;if(a="undefined"==typeof a?"":a,"undefined"!=typeof t)for(;o<t.length;o++)e(n+t[o]+a)[i]()},_selectSingleImage:function(){null===PUM_ATB._singleImageSelector&&(PUM_ATB._singleImageSelector=wp.media({title:n.selectImage,button:{text:n.selectImage},library:{type:"image"},multiple:!1})),PUM_ATB._singleImageSelector.once("open",e.proxy(PUM_ATB._singleImageOpened,this)),PUM_ATB._singleImageSelector.once("select",e.proxy(PUM_ATB._singleImageSelected,this)),PUM_ATB._singleImageSelector.open()},_singleImageOpened:function(){var t=PUM_ATB._singleImageSelector.state().get("selection"),i=e(this).closest(".pum-image-field"),n=i.find("input[type=hidden]"),a=n.val(),o=null;e(this).hasClass("pum-image-replace")?(t.reset(),i.addClass("pum-image-empty"),n.val("")):""!==a?(o=wp.media.attachment(a),o.fetch(),t.add(o?[o]:[])):t.reset()},_singleImageSelected:function(){var t=PUM_ATB._singleImageSelector.state().get("selection").first().toJSON(),i=e(this).closest(".pum-image-field"),n=i.find("input[type=hidden]"),a=i.find(".pum-image-preview img"),o=i.find("select");n.val(t.id),a.attr("src",PUM_ATB._getImageSrc(t)),i.removeClass("pum-image-empty"),i.find("label.error").remove(),o.show(),o.html(PUM_ATB._getImageSizeOptions(t)),o.trigger("change")},_singleImageRemoved:function(){var t=PUM_ATB._singleImageSelector.state().get("selection"),i=e(this).closest(".pum-image-field"),n=i.find("input[type=hidden]"),a=i.find("select");t.reset(),i.addClass("pum-image-empty"),n.val(""),a.html(""),a.trigger("change")},_getImageSrc:function(e){return"undefined"==typeof e.sizes?e.url:"undefined"!=typeof e.sizes.thumbnail?e.sizes.thumbnail.url:e.sizes.full.url},_getImageSizeOptions:function(e){var t="",a=null,o=null,l=null,s="",r={full:n.fullSize,large:n.large,medium:n.medium,thumbnail:n.thumbnail},p=!1;if("undefined"!=typeof e.sizes)for(a in e.sizes)e.sizes.hasOwnProperty(a)&&(s="undefined"!=typeof r[a]?r[a]+" - ":void 0!==i&&void 0!==i.config&&void 0!==i.config.customImageSizeTitles[a]?i.config.customImageSizeTitles[a]+" - ":"","full"===a&&(p=!0),l=a===o?' selected="selected"':"",t+='<option value="'+e.sizes[a].url+'"'+l+">"+s+e.sizes[a].width+" x "+e.sizes[a].height+"</option>");return p||(l=o&&"full"!==o?"":' selected="selected"',t+='<option value="'+e.url+'"'+l+">"+n.fullSize+"</option>"),t}},PUM_ATB._init()}(jQuery,document,pum_atb);